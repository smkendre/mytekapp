<app-topbar></app-topbar>
<ion-content>

  <ion-row>
    <ion-col size="12">
      <div class="ion-text-center" *ngIf="isLoading">
        <ion-spinner color="primary"></ion-spinner>

      </div>
      <div class="ion-text-center" *ngIf="!isLoading && Report.length <= 0">

        <p> No Reports Found !</p>
      </div>
    </ion-col>
  </ion-row>


  <ion-grid class="ion-no-padding" *ngIf="!isLoading && Report.length > 0">

    <div *ngFor="let row of Report">
      <ion-card class="transparent-card">
        <ion-card-content>
          <ion-row>
            <ion-col size="10" size-sm="10">


              <h1 class="ion-text-left"> Report for - {{row.name}}</h1>

            </ion-col>
            <ion-col size="2" size-sm="2">


              <ion-button color="success" class="ion-text-right" [routerLink]="['/', 'submit-report', row.id]"   >Add
              </ion-button>

            </ion-col>

          </ion-row>
        </ion-card-content>
      </ion-card>

      <div *ngIf=" row.report.length > 0">
        <ion-card class="btn-grad" *ngFor="let report of row.report">

          <ion-card-content>
            <ion-row>
              <ion-col size="12" size-sm="12">
                <h2>{{report.created_at | date: 'dd MMMM yyyy, hh:mm a'}}
                </h2>

              </ion-col>


              <ion-col size="12" size-sm="12" *ngFor="let field of report.data ">

                <h3><strong>{{field.key}}: </strong>{{field.value}}</h3>

              </ion-col>
              <ion-col size="12" size-sm="12">
                <h3> <strong> Comment: </strong>{{report.comment}}</h3>

              </ion-col>
              <ion-col size="12" size-sm="12">
                <h3> <strong> Submitted By: </strong>{{report.username}}</h3>

              </ion-col>
              <ion-col size="12" size-sm="12">
                <h3> <strong> Status: </strong>{{report.status}}</h3>

              </ion-col>
              <ion-col size="12" size-sm="12" *ngIf="report.files && report.files.length > 0">
                <strong> Uploaded File: </strong> <img [src]="getImageUrl(report.files)" width="30px" alt="" />

              </ion-col>

              <ion-col size="12" size-sm="12" *ngIf="report.status == 'pending' && userRole == 4">
                <ion-button color="success" (click)="updateStatus('accepted', report.id)">Approve</ion-button>
                <ion-button color="danger" (click)="updateStatus('rejected', report.id)">Reject</ion-button>
              </ion-col>


            </ion-row>


          </ion-card-content>
        </ion-card>
      </div>
      <ion-label *ngIf=" row.report.length <= 0">
        <ion-card class="transparent-card">
          <ion-card-content>
            <ion-row>
              <ion-col size="12" size-sm="12">


                <h3> No reports submitted yet</h3>


              </ion-col>

            </ion-row>
          </ion-card-content>
        </ion-card>
      </ion-label>
    </div>

  </ion-grid>
</ion-content>
<app-footer></app-footer>
